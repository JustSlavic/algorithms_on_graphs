# Задание 4: Игра в слова

## Тема задания: минимальное остовное дерево

### Условие задачи:

Создатели паутины слов пришли к выводу, что их паутина сбоит. *В*-создатель
создатель говорит, что его вертикальные слова не могут приводить к сбоям в эфире, а
*Г*-создатель то же самое утверждает о сотворенных им горизонтальных словах. Их спор
разрешил *Д*-создатель, который сформулировал принцип конфликта духа паутины слов.
Итак, паутина слов была создана из горизонтальных и вертикальных слов. Важным
фактором является пересечение слов этих двух типов. Эти пересечения образуют точки
концентрации духа паутины. А важность этих точек связана с двумя аспектами: во-
первых, слова одного типа пересечься не могут в принципе, а во-вторых,
противоположная направленность пересекающихся слов, дополняет точку пересечения,
как *Г*-духом, так и *В*-духом. Конфликт духа паутины возникает вследствие того, что
возникающая в паутине энергия начинает циркулировать по образовавшимся метациклам.
Под метациклом понимается последовательность точек концентрации духа такая, что
каждая следующая связана с предыдущей точкой концентрации частью вертикального или
горизонтального слова. Чтобы прекратить сбои необходимо удалить части некоторых
вертикальных и/или горизонтальных слов.
Ваша миссия состоит в том, чтобы проанализировать существующие вертикальные и
горизонтальные слова в паутине, затем определить точки концентрации духа, после чего
разорвать существующие метациклы, путем удаления частей слов, соединяющих
некоторые из пар точек концентрации. Главное! Суммарное число оставшихся букв
должно быть минимально!

### Формат входного файла

Первая строка входного файла содержит числа `H` и `V` `(1 ≤ H, V ≤ 1000)` — число
горизонтальных и вертикальных слов в паутине.
Следующие `H` строк содержат описания горизонтальных слов. Описание
представляет собой три числа: `r, c1, c2 (0 ≤ r, c1, c2 ≤ 106, c1 < c2)` такие, что
соответствующее слово начинается в клетке `(r, c1)` и оканчивается в клетке `(r, c2)`.
Следующие `V` строк содержат описания вертикальных слов. Описание представляет
собой три числа: `r1, r2, c (0 ≤ r1, r2, c ≤ 106
, r1 < r2)` такие, что соответствующее слово
начинается в клетке `(r1, c)` и оканчивается в клетке `(r2, c)`.

### Формат выходного файла

Выведите единственное число минимально возможное суммарное количество
оставшихся букв. Если разрыв всех метациклов невозможен, то вывести `-1`.

go to [master](https://github.com/JustSlavic/algorithms_on_graphs).